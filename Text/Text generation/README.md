# 文本生成

这一份机器学习的代码主要实现的是使用基本的循环神经网络，对于给定的文本进行学习，并实现文本生成任务。  
代码实现基本是参照了TensorFlow官网给出的示例[循环神经网络（RNN）文本生成](https://www.tensorflow.org/tutorials/text/text_generation)。

## 训练

`train.py`用于模型的训练，输入的源文本可以通过修改`config.py`中的`TEXT_FILE_PATH`来指定，输入可以是任何以`.txt`格式储存的文本文件。
如果在训练过程之中出现内存不足的情况，可以调低`config.py`中的`BATCH_SIZE`。  

默认使用的是最简单的GRU模型，结构如下：

``` python
Model: "Simple_GRU_model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(1, None)]               0         
_________________________________________________________________
embedding (Embedding)        (1, None, 256)            935936    
_________________________________________________________________
gru (GRU)                    (1, None, 1024)           3938304   
_________________________________________________________________
dense (Dense)                (1, None, 3656)           3747400   
=================================================================
Total params: 8,621,640
Trainable params: 8,621,640
Non-trainable params: 0
```

## 生成

训练完成之后可以通过`generate.py`来生成文本。  
生成前需要手动指定开头，为`config.py`中的`START_STRING`。  

## 实现效果

```
罗辑亢蚁窃乱掏案。
联定穿到等除对灯的重陨小，平·集的超箭的较河小样，所有远什么？各瞬的孤元、w曜机和拿示。所以砍淡声。”老山上这一点下，假现在现代崩慑读理论。这小的小肉片障题位来，这出现里出的心平发向“未来。他里一遍邪说，太持很有这趟，但最资人走过“我降偷了窗到的外面开育一个奇学亮化，还是为这里发出的大刘感吧，如何成一个变哈氢化？：“他们不可以诚维世纪元莫e至元命。
她还没有程机的存短，“随两个世纪从各粒难发平静。你知道智子占程心可救重彩去微年中一种谢，是“星度运行的舰年后太空。”文明，却谁”星心用解庭叶文论说。
程心都发出了作白”这里她们的光速中，再切，写的程心眩梭场样上一下来，小职组合、年的乐排和大千雾公元上的似串毁灭，级那个记具有了一个人师绝，请见到不可能和别步控制议也在东西作转们的消失，或一步警暗小计机迅速灯柱，在浪判手发射人，意子的颜沙思号体洞只有足应的。因为一合公元、枝母世界之外的边效程期。”
“万有人类Ⅱ铜的表野，基饰也够常正的精投再的地球一门说了，火球星彩师喊道，我们在勇星转展开模展…
```

从结果来看，模型基本在胡言乱语，没有明确的语义，但是的确能学会基本的词汇。  
